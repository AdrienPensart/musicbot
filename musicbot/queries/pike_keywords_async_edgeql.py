# AUTOGENERATED FROM 'musicbot/queries/pike_keywords.edgeql' WITH:
#     $ gel-py --dir musicbot/queries -I musicbot-prod


from __future__ import annotations

import gel


async def pike_keywords(
    executor: gel.AsyncIOExecutor,
) -> list[str]:
    return await executor.query(
        """\
        for keyword in (
            select Keyword {name}
            filter contains(array_agg(.musics.keywords.name), 'pike') and .musics.rating >= 4.0 and .musics.album.artist.name = 'Buckethead'
        )
        union (keyword.name) except {'pike'}\
        """,
    )
